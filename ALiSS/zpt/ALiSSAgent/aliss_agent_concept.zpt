<tal:block tal:replace="structure here/standard_html_header"/>
<span tal:replace="python:request.RESPONSE.setHeader('content-type', 'text/html;charset=UTF-8')"/>

<tal:block	define="utils			modules/Products.ALiSS.utils;
					term_name		python:utils.utToUnicode(request.get('term', ''));
					lang			python:request.get('SELECTED_LANGUAGE', 'en');
					aliss_concept	python:here.getConceptDetails(term_name, lang)">

	<!-- Alphabet listing and navigation -->
	<tal:block define="dtype here/getDisplayType;
						data python:here.generateMenu(lang);
						totalConcepts python:data[0];
						menuData python:data[1]">
		<ul class="alphabet_list">
			<li tal:condition="dtype"
				tal:define="has_content python:here.hasDigits(menuData);
							param_letter python:test(dtype, 'num', '1')"
				style="padding-left: 0.4em">
				<a	tal:condition="has_content" title="0-9" class="menu_link"
					tal:attributes="href string:${here/absolute_url}/list_html?letter=${param_letter}">0-9</a>
				<span	tal:condition="not:has_content" class="menu_empty">0-9</span>
			</li>

			<li tal:repeat="data_letter python:here.unicode_map(lang)" tal:condition="dtype">
				<tal:menu define="letter python:data_letter[1].encode('utf8');
									has_content python:menuData.has_key(letter)">
					<tal:block condition="has_content">
						<a	class="menu_link"
							tal:define="conceptsNumber python:menuData[letter]"
							tal:attributes="href string:${here/absolute_url}/list_html?letter=${letter};
											title string:${conceptsNumber} terms"
							tal:content="letter" />
					</tal:block>
					<span	tal:condition="not:has_content"
							tal:content="letter" class="menu_empty" />
				</tal:menu>
			</li>

		<li tal:define="has_content python:here.hasOther(menuData, lang)"
			style="padding-right: 0.4em">
			<tal:block condition="has_content">
				<a	tal:condition="has_content" title="Other" class="menu_link"
					tal:attributes="href string:${here/absolute_url}/list_html?letter=other;title python:context.messages('Other')" tal:content="python:context.messages('Other')">Other</a>
				<span class="menu_selected" tal:condition="not:has_content" tal:content="python:context.messages('Other')">Other</span>
			</tal:block>
		</li>

			<li tal:condition="not:dtype">
				<a	tal:attributes="href string:${here/absolute_url}/list_html?letter=all" title="Terms list">
				View terms list</a>
			</li>
		</ul>
	</tal:block>

	<!-- Case of NO TERM found -->
	<div tal:condition="not:aliss_concept" id="no_concept_area">
			<h1><em tal:content="term_name" /></h1>
			<p><span tal:replace="python:context.messages('There are no items to display at the moment')">Definition not 
available</span>.</p>
	</div>

	<!-- Google custom search area -->
	<div metal:define-macro="googlecse" id="google-custom-search-area" tal:attributes="style python:test(aliss_concept, 'width:47%', 'width:100%')">
		<h1>EEA website search</h1>
		<div id="googlecse-result" metal:define-macro="googlecse-result">
			<span tal:replace="structure here/google_cs_ajax_js" />
			<div id="GCSSearchForm">Loading...</div>
			<div id="rightSearchControl" class="search-control">Loading...</div>
			<p class="discreet">powered by <a href="http://code.google.com/apis/ajaxsearch/index.html"><span class="tagline">The Google AJAX Search API</span></a> and <a href="http://www.google.com/coop/cse"><span class="tagline">Google Custom Search Engines</span></a></p>
		</div>
	</div>

	<!-- Case of TERM found -->
	<tal:block	condition="aliss_concept">
		<tal:block	define="concept_name		python:aliss_concept['term_name'];
							concept_url			python:aliss_concept['term_url'];
							concept_definitions	python:aliss_concept['definitions'];
							translations		python:aliss_concept['translations'];
							terms_list			python:aliss_concept['terms_list']">
			<div id="concept_area">
			<h1 tal:content="concept_name" />

			<!-- MediaWiki images -->
			<div metal:define-macro="wikimedia-images" id="wikimedia-area" tal:condition="here/getWikiState">
				<a style="float: right; border: 1px solid #ccc; background-color: #f0f0f0; padding: 1px;" target="_blank" tal:attributes="href string:http://www.eea.europa.eu/help/contact-info?message=${template/absolute_url}?term=${term_name}">report bad image</a>
				<h2>Sample images</h2>
				<br clear="all" />
				<script tal:attributes="src string:${here/absolute_url}/misc_/ALiSS/qTip.js" type="text/javascript"></script>
				<script tal:attributes="src string:${here/absolute_url}/misc_/ALiSS/gfslideshow.js" type="text/javascript"></script>
				<tal:block content="structure python:here.getWikiFeddJS(term_name)" />
				<div id="body">
				<a style="float: right" title="" class="link-rss" tal:attributes="title python:'Media feed for '+term_name;href string:${here/absolute_url}/getWikiFeed?query=${term_name}">Media RSS</a>
					<div id="slideshow" class="gss figure-container">Loading...</div>
				</div>
				<br clear="all" />
				<div id="image-info" class="discreet">
					<span>Author: <span id="wiki-author"></span></span><br />
					Credits: <a id="photo_credit" href="#">Wikimedia Commons</a>
				</div>
				<br clear="all" />
			</div>

			<!-- Definitions and translations -->
			<div metal:define-macro="definitions" id="definitions-area">
			<h2><span tal:replace="python:context.messages('Definitions')">Definitions</span> (<span tal:replace="python:context.messages('English')">English</span>)</h2>
			<p tal:condition="python:len(concept_definitions.keys())<2 and 
concept_definitions[concept_definitions.keys()[0]]=='Definition not available.' "><span tal:replace="python:context.messages('There are no items to display at the moment')">Definition not available</span>.</p>
			<dl class="definitions_list" tal:condition="concept_definitions">
				<dt tal:content="concept_name" />
				<tal:block repeat="source_url python:concept_definitions.keys()">
					<tal:block define="source_text python:utils.utUrlDecode(source_url)">
						<dd  tal:condition="python:concept_definitions[source_url]!='Definition not available.'">
							<tal:block	condition="python:concept_definitions[source_url]!='Definition not available.'" 
										define="terms_indef python:here.getTermsInText(concept_definitions[source_url],100)">
							<div tal:content="structure terms_indef/marked_text" />
							<div class="definition_source">
								<p> <strong>Terminology source:</strong>
									<a  tal:define="url_idx python:source_url.find('/',8)"
										tal:attributes="href string:terminology_sources_html;title source_url;"
										title="terminology tool source"
										tal:content="python:source_text[:int(url_idx)]" /></p>
							</div>
							</tal:block>
						</dd>
					</tal:block>
				</tal:block>
			</dl>
			<p class="more_definitions"><a class="moreLink" tal:attributes="href string:http://www.google.com/search?q=define%3A${concept_url}&amp;start=0&amp;start=0&amp;ie=utf-8&amp;oe=utf-8">Find definitions (via Google)</a></p>
			<br clear="all" />
			</div>

			<div metal:define-macro="translations" id="translations-area">
			<h2 tal:content="python:context.messages('Translations')">Translations</h2>
			<ul tal:condition="python:len(translations.keys())>0"
				tal:define="trans python:translations.keys();
							transcodes python:trans.sort()">
				<tal:block repeat="langcode trans">
				<li tal:condition="python:langcode != lang">
					<span class="langcode" tal:content="langcode" /> <a tal:attributes="href python:here.generateTransLink(lang, langcode)+'/sitesearch?term='+' '.join(translations[langcode])"><span tal:content="python:'; '.join(translations[langcode])" /></a>
				</li>
				</tal:block>
			</ul>
			<p tal:condition="python:len(translations.keys())<1"><span tal:replace="python:context.messages('There are no items to display at the moment')" />.</p>
			</div>

			<tal:block	define="statistics python:here.getContentGroups()">
				<tal:block	condition="python:len(statistics)>0"
								repeat="group_id statistics">
					<tal:block	define="google_list		python:here.mergeTopResults(group_id, terms_list, 10);
										cg_name			python:google_list[group_id]['cg_name'];
										cg_updated		python:google_list[group_id]['cg_updated'];
										google_pages	python:google_list[group_id]['google_pages']">

						<tal:block condition="not:google_pages">
							<h5 tal:content="cg_name" />
							<p>No pages were indexed.</p>
						</tal:block>
						
						<tal:block	condition="google_pages"
									repeat="content_group python:google_list.keys()">
							<h5 tal:content="cg_name" />
							<ol>
								<li class="AlissRow" tal:repeat="page google_pages">
									<a tal:attributes="href python:page.page_url"><img class="preview" tal:attributes="src python:test(len(page.getPreviewImageUrl())>0, page.getPreviewImageUrl(), '/misc_/ALiSS/standardicon.gif')" alt="Thumbnail preview" /><span tal:replace="structure python:test(len(page.page_title)!=0, page.page_title, 'Title N/A')"/></a>
									<br/><span tal:replace="structure python:page.page_snippet"/>
								<br clear="all" /></li>
							</ol>
						</tal:block>
					</tal:block>
				</tal:block>
			</tal:block>

			<tal:block metal:define-macro="suggestions" define="related_terms python:here.getTermSuggestionsBrains(concept_name,True,lang)">
			<div id="see-also" tal:condition="python:len(related_terms)>0">
				<h2 tal:content="python:context.messages('Related themes')">Related themes</h2>
				<ul class="concept_list">
					<tal:block tal:repeat="term_sugg related_terms" tal:on-error="nothing">
						<li tal:define="term python:term_sugg.getTranslation(lang)">
							<a	tal:attributes="href string:${here/absolute_url}/concept_html?term=${term};
												title term"
								tal:content="term">term related</a>
						</li>
					</tal:block>
				</ul>
			</div>
			</tal:block>

			</div>

		</tal:block>
	</tal:block>


</tal:block>

<tal:block tal:replace="structure here/standard_html_footer"/>
